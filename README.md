质监审查员系统 - 移动客户端API
==============================

 

本接口程序被设计用来支撑移动客户端功能，所有API均为 http web
service，数据交换格式为JSON。

接口若支持POST方式访问，则一般也支持GET方式访问（特殊情况除外，如：文件上传），最佳访问方式请参照各API定义中的建议。

对于接口访问的请求示例，若支持POST，则给出POST
报文样例（仅供参考，若要调试，请使用调试工具自行按要求设置入参），否则给出GET样例，若同时支持，则只给出POST样例，GET方式的请求，请参见HTTP规范自行组织。

对于入参组织结构，若入参为非结构化数据（比如：登录账号、密码，无需作为对象结构传入），则均采用
application/x-www-form-urlencoded 内容类型，否则，采用 application/json。

 

接口规范
--------

接口服务器参数：

domain\_name: 192.168.10.70

port: 8000

请在构造API地址时，将 domain\_name 与 port 部分用以上参数替换。

 

所有接口响应均遵循以下格式：

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
{
  "code" : 1,
  "message" : null,
  "body" : {
    "success" : true,
    "error" : null,
    "data" : {
      
    }
  }
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

| **字段**     | **含义**                          | **必填** | **备注**                                                                    |
|--------------|-----------------------------------|----------|-----------------------------------------------------------------------------|
| code         | 本次API调用结果                   | Y        | 指示API调用过程是否完整（无网络错误或异常），详见接口常量定义一节           |
| message      | 当出现错误或异常时的调试信息      | N        |                                                                             |
| body         | 本次API响应的主体                 | Y        | 类似HTTP body，用于包装数据和业务逻辑代码                                   |
| body.success | 业务逻辑是否正确执行              | Y        | 不同于code，该字段指示业务级的“正确”或“失败“，例如：登录失败，此处返回false |
| body.error   | 当出现业务错误时返回的调试信息    | N        |                                                                             |
| body.data    | 响应数据的根节点（详见各API定义） | N        | 根据具体业务逻辑，非数据接口可能不包含该节点                                |

 

接口常量定义
------------

本节定义接口中的常量信息，如：API响应代码，业务错误码等。

 

### API响应代码

| **代码** | **含义**     |
|----------|--------------|
| 1        | 成功         |
| 2        | 入参错误     |
| 3        | 系统内部错误 |
| 4        | 未知错误     |

 

### 业务错误码

| **代码** | **含义**                             |
|----------|--------------------------------------|
| 1        | 账号或密码不正确，登录授权失败       |
| 2        | 非法的用户角色（例如：非审查员登录） |

 

接口详细定义
------------

本节介绍各接口详细信息，入参，响应数据结构和注意事项。

 

### 审查员登录

地址：http://domain\_name:port/api/censor/login

请求方式：GET/POST （建议POST）

 

**入参:**

| **字段**      | **含义**       | **必传** | 备注                   |
|---------------|----------------|----------|------------------------|
| login\_id     | 审查员登录账号 | Y        |                        |
| password      | 审查员登录密码 | Y        | MD5 密文               |
| device\_token | 设备唯一标识   | Y        | 用于推送消息的设备标识 |
| client\_type  | 客户端类型     | Y        | 1: iOS, 2: Android     |

 

**请求示例:**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
POST /api/censor/login HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Host: domain_name:port
Content-Length: 124
Connection: Keep-Alive
Cache-Control: no-cache

login_id=testAccount&password=922b4dcf821a2f8d43e23f133acf1e83&device_token=745b9da069a02ed49765010ab8b3390dbbb8b3fcc049b2f681e3241787aa525f&client_type=1
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

**响应：**

| **字段**                   | **含义**       | **必传** | **备注**                    |
|----------------------------|----------------|----------|-----------------------------|
| account                    | 审查员账号信息 |          |                             |
| account.uid                | 账号唯一标识   | Y        | 其他API入参可能要使用此字段 |
| account.staffCode          | 登陆名         | Y        |                             |
| account.apiAccessToken     | API访问授权码  | Y        | 用于在后续API调用中鉴权     |
| profile                    | 审查员个人资料 |          |                             |
| profile.profileId          | 个人资料ID     | Y        | 其他API入参可能要使用此字段 |
| profile.name               | 姓名           | Y        |                             |
| profile.mobilePhone        | 手机           | N        |                             |
| profile.officeTel          | 工作电话       | N        |                             |
| profile.homeTel            | 家庭电话       | N        |                             |
| profile.address            | 地址           | N        |                             |
| profile.zipcode            | 邮编           | N        |                             |
| profile.email              | 邮箱地址       | N        |                             |
| profile.majors             | 审查员专业方向 | Y        |                             |
| profile.majors.belongTrade | 专业           | Y        |                             |
| profile.majors.enrollRank  | 级别           | Y        | S 审查员，Z 审查组长        |
| profile.majors.tradeField  | 行业           | Y        |                             |

 

**响应示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
{
  "code" : 1,
  "body" : {
    "success" : true,
    "data" : {
      "account" : {
        "staffCode" : "hankai",
        "lastLoginTime" : "1453941692",
        "uid" : 5533
      },
      "profile" : {
        "name" : "韩凯111",
        "mobilePhone" : "17761740251",
        "officeTel" : "025-8777????",
        "homeTel" : "025-8777????",
        "address" : "编辑个人资料-单元测试",
        "zipcode" : "210019",
        "email" : "hankai@sparksoft.com.cn",
        "majors" : [
          {
            "belongTrade" : "电线电缆",
            "enrollRank" : "Z",
            "tradeField" : "工业产品生产许可审查"
          },
          {
            "belongTrade" : "人造板",
            "enrollRank" : "Z",
            "tradeField" : "工业产品生产许可审查"
          },
          {
            "belongTrade" : "耐火材料",
            "enrollRank" : "Z",
            "tradeField" : "工业产品生产许可审查"
          }
        ],
        "profileId" : "5528_876_12"
      }
    }
  }
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

### 审查员头像下载

地址：http://domain\_name:port/api/censor/avatar

请求方式：GET/POST（建议GET）

 

**入参：**

| **字段** | **含义**           | **必传** | **备注** |
|----------|--------------------|----------|----------|
| uid      | 审查员账号唯一标识 | Y        |          |

 

**请求示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
http://domain_name:port/api/censor/avatar?uid=5533
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

**响应：**

响应内容为图片数据，直接将数据渲染到图片容器即可。

 

### 审查员个人资料查询接口

地址：http://domain\_name:port/api/censor/profile

请求方式：GET

 

**入参：**

| **字段** | **含义**     | **必传** | **备注** |
|----------|--------------|----------|----------|
| uid      | 审查员账号ID | Y        |          |

 

**请求示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
http://domain_name:port/api/censor/profile?uid=5533
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

**响应：**

| **字段**                   | **含义**       | **必传** | **备注**                    |
|----------------------------|----------------|----------|-----------------------------|
| profileId                  | 个人资料ID     | Y        | 其他API入参可能要使用此字段 |
| name                       | 姓名           | Y        |                             |
| mobilePhone                | 手机           | N        |                             |
| officeTel                  | 工作电话       | N        |                             |
| homeTel                    | 家庭电话       | N        |                             |
| address                    | 地址           | N        |                             |
| zipcode                    | 邮编           | N        |                             |
| email                      | 邮箱地址       | N        |                             |
| profile.majors             | 审查员专业方向 | N        |                             |
| profile.majors.belongTrade | 专业           | Y        |                             |
| profile.majors.enrollRank  | 级别           | Y        | S 审查员，Z 审查组长        |
| profile.majors.tradeField  | 行业           | Y        |                             |

 

**响应示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
{
  "code" : 1,
  "body" : {
    "success" : true,
    "data" : {
      "name" : "韩凯",
      "mobilePhone" : "17761748443",
      "officeTel" : "025-87775050",
      "homeTel" : "025-87775050",
      "address" : "编辑个人资料-单元测试",
      "zipcode" : "210019",
      "email" : "hankai@sparksoft.com.cn?",
      "majors" : [
        {
          "belongTrade" : "电线电缆",
          "enrollRank" : "Z",
          "tradeField" : "工业产品生产许可审查"
        },
        {
          "belongTrade" : "人造板",
          "enrollRank" : "Z",
          "tradeField" : "工业产品生产许可审查"
        },
        {
          "belongTrade" : "耐火材料",
          "enrollRank" : "Z",
          "tradeField" : "工业产品生产许可审查"
        }
      ],
      "profileId" : "5528_876_12"
    }
  }
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

### 审查员个人资料更新接口

地址：http://domain\_name:port/api/censor/profile

请求方式：POST（multipart/form-data）

 

因为无法判断是清空某个字段还是不需要修改，所以所有入参一律必传。

**入参：**

| **字段**            | **含义**       | **必传** | **备注**                                                |
|---------------------|----------------|----------|---------------------------------------------------------|
| profile             | 个人资料       | Y        | 请按要求将该节点所有字段组织成JSON对象作为form-data传递 |
| profile.uid         | 审查员账号ID   | Y        |                                                         |
| profile.name        | 审查员姓名     | Y        |                                                         |
| profile.mobilePhone | 手机           | Y        |                                                         |
| profile.officeTel   | 工作电话       | Y        |                                                         |
| profile.homeTel     | 家庭电话       | Y        |                                                         |
| profile.address     | 地址           | Y        |                                                         |
| profile.zipcode     | 邮编           | Y        |                                                         |
| profile.email       | 邮箱地址       | Y        |                                                         |
| avatar              | 审查员头像图片 | N        | 请将图片组织成 form-data传递                            |

 

**请求示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
POST /api/censor/profile HTTP/1.1
Host: localhost:8000
Content-Type: multipart/form-data;boundary=----175a5274fa537f856d116be2f6542033
Connection: keep-alive
Accept: */*
User-Agent: iOSDemo/1 CFNetwork/758.2.8 Darwin/15.2.0
Content-Length: 42977
Accept-Language: en-us
Accept-Encoding: gzip, deflate
------175a5274fa537f856d116be2f6542033
Content-Disposition: form-data; name="profile"
Content-Type: application/json

{"uid": 5533, "name": "韩凯", "mobilePhone": "17761748443", "officeTel": "025-87775050", "homeTel": "025-87775050", "address": "奥体大街", "zipcode": "210019", "email": "hankai@sparksoft.com.cn"}
------175a5274fa537f856d116be2f6542033
Content-Disposition: form-data; name="avatar"; filename="avatar.jpg"
Content-Type: image/jpeg

[avatar image data ...]
------175a5274fa537f856d116be2f6542033--
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

**响应：**

该接口为非数据接口，因此不返回任何数据，仅返回是否成功。

 

**响应示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
{
  "code" : 1,
  "body" : {
    "success" : true
  }
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

### 查询审查员未反馈的计划

地址：http://domain\_name:port/api/plan/not\_reviewed

请求方式：GET/POST（建议GET）

 

**入参：**

| **字段** | **含义**           | **必传** | **备注** |
|----------|--------------------|----------|----------|
| uid      | 审查员账号唯一标识 | Y        |          |

 

**请求示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
POST /api/plan/not_reviewed HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Host: domain_name:port
Content-Length: 124
Connection: Keep-Alive
Cache-Control: no-cache

uid=3804
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

**响应：**

| **字段**              | **含义**             | **必传** | **备注**                                               |
|-----------------------|----------------------|----------|--------------------------------------------------------|
| [].id                 | 审查计划唯一标识     | Y        |                                                        |
| [].corpName           | 待审查的企业名称     | Y        |                                                        |
| [].productType        | 产品类型             | Y        |                                                        |
| [].productName        | 产品名称             | Y        |                                                        |
| [].checkDate          | 核查日期             | N        | 由组员和组长商议确定的审查日期                         |
| [].appointDate        | 审查开始日期         | Y        | 基于毫秒数的时间戳                                     |
| [].finishDate         | 审查结束日期         | Y        | 基于毫秒数的时间戳                                     |
| [].feedbackResult     | 反馈信息             | N        | 计划反馈的代码，A：接受，B：拒绝                       |
| [].canChangeCheckDate | 是否可以修改审查日期 | Y        | 根据当前审查员在该计划中的角色（审查员，审查组长）得到 |

 

**响应示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
{
  "code" : 1,
  "body" : {
    "success" : true,
    "data" : [
      {
        "id" : "7368_876_2",
        "corpName" : "江苏省颠颠电线电缆公司，",
        "productType" : "电线电缆",
        "productName" : "电线电缆",
        "checkDate" : "1453824000",
        "appointDate" : "1453824000",
        "finishDate" : "1455120000",
        "feedbackResult" : "A",
        "canChangeCheckDate" : true
      }
    ]
  }
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

### 消息推送接口

地址：http://domain\_name:port/api/censor/push

请求方式：POST

 

**入参：**

| **字段**    | **含义**                   | **必传** | **备注**                             |
|-------------|----------------------------|----------|--------------------------------------|
| deviceToken | 设备唯一标识               | Y        | 客户端登录后回传该字段后被插入数据库 |
| clientType  | 客户端类型                 | Y        | 1: iOS, 2: android                   |
| content     | 推送的消息内容（50字以内） | Y        | 例如：新计划！XXX制造有限公司        |

 

**请求示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
POST /api/censor/push HTTP/1.1
Content-Type: application/json
Host: domain_name:port
Content-Length: 124
Connection: Keep-Alive
Cache-Control: no-cache

{"deviceToken" : "745b9da069a02ed49765010ab8b3390dbbb8b3fcc049b2f681e3241787aa525f","clientType" : 1,"content" : "新计划！XXX制造有限公司"}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

Body 部分特写：

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
{
  "deviceToken" : "745b9da069a02ed49765010ab8b3390dbbb8b3fcc049b2f681e3241787aa525f",
  "clientType" : 1,
  "content" : "新计划！XXX制造有限公司"
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

**响应：**

该接口为非数据接口，因此不返回任何数据，仅返回是否成功。

 

**响应示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
{
  "code" : 1,
  "body" : {
    "success" : true
  }
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

### 提交计划反馈接口

地址：http://domain\_name:port/api/plan/feedback

请求方式：POST

 

**入参：**

| **字段**    | **含义**                      | **必传** | **备注**   |
|-------------|-------------------------------|----------|------------|
| profile\_id | 审查员个人资料ID              | Y        | 登录后回传 |
| plan\_id    | 审查计划ID                    | Y        |            |
| type        | 反馈类型（1:接受，2:拒绝）    | Y        |            |
| reason      | 拒绝原因（仅当type为2时有效） | N        |            |

 

**请求示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
POST /api/plan/feedback HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Host: domain_name:port
Content-Length: 124
Connection: Keep-Alive
Cache-Control: no-cache

profile_id=103_42_32&plan_id=33_44_55&type=2&reason=测试拒绝反馈
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

**响应：**

该接口为非数据接口，因此不返回任何数据，仅返回是否成功。

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
{
  "code" : 1,
  "body" : {
    "success" : true
  }
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

### 设置计划的审查日期

地址：http://domain\_name:port/api/plan/set\_check\_date

请求方式：GET/POST（建议GET）

 

**入参：**

| **字段**    | **含义**             | **必传** | **备注**                             |
|-------------|----------------------|----------|--------------------------------------|
| plan\_id    | 审查计划ID           | Y        | 由 “查询审查员未反馈的计划” 接口返回 |
| check\_date | 客户端选取的审查日期 | Y        | 时间戳（1970年后的秒数）             |

 

**请求示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
http://domain_name:port/api/plan/check_date?plan_id=7368_876_2&check_date=1453824000
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

**响应：**

该接口为非数据接口，因此不返回任何数据，仅返回是否成功。

 

**响应示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
{
  "code" : 1,
  "body" : {
    "success" : true
  }
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

### 未核查的企业查询接口

企业定位和设备核查功能共用该接口获取企业列表。

地址：http://domain\_name:port/api/corp/not\_checked

请求方式：GET/POST（建议GET）

 

**入参：**

| **字段** | **含义**     | **必传** | **备注** |
|----------|--------------|----------|----------|
| uid      | 审查员账号ID | Y        |          |

 

**请求示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
http://domain_name:port/api/corp/not_checked?uid=4075
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

**响应：**

| **字段**                 | **含义**                       | **必传** | **备注**                         |
|--------------------------|--------------------------------|----------|----------------------------------|
| [].id                    | 企业ID                         | Y        |                                  |
| [].name                  | 企业名称                       | Y        |                                  |
| [].addr                  | 企业住所                       | Y        |                                  |
| [].productType           | 产品类型                       | Y        |                                  |
| [].productName           | 产品名称                       | Y        |                                  |
| [].locationAddr          | 企业实际住所（审查员定位获得） | N        | 为空表示未定位，反之表示已定位   |
| [].photoUrls             | 门头照片url数组                | N        | 相对url，使用时需要拼接API根地址 |
| [].products              | 企业申报的产品列表             | N        |                                  |
| [].products.id           | 产品ID                         | Y        |                                  |
| [].products.productUnit  | 产品单元                       | Y        |                                  |
| [].products.productKind  | 产品类型                       | Y        |                                  |
| [].checkItems            | 企业产品对应的核查项目         | N        |                                  |
| [].checkItems.id         | 核查项目ID                     | Y        |                                  |
| [].checkItems.itemNumber | 核查项目序号                   | Y        |                                  |
| [].checkItems.itemName   | 核查项目名称                   | Y        |                                  |
| [].checkItems.content    | 核查项目内容                   | Y        |                                  |

 

响应示例：

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
{
  "code" : 1,
  "body" : {
    "success" : true,
    "data" : [
      {
        "id" : 7367,
        "name" : "江苏省颠颠电线电缆公司",
        "addr" : "南京",
        "productType" : "电线电缆",
        "productName" : "电线电缆",
        "locationAddr" : "中国江苏省南京市建邺区建邺区新城科技园楠溪江东街36号",
        "products" : [
          {
            "id" : 154,
            "productUnit" : "塑料绝缘控制电缆",
            "productKind" : "聚氯乙烯绝缘控制电缆"
          },
          {
            "id" : 153,
            "productUnit" : "漆包圆绕组线",
            "productKind" : "直焊聚氨酯漆包铜圆线"
          }
        ],
        "checkItems" : [
          {
            "id" : 1,
            "itemNumber" : "1.1",
            "itemName" : "组织机构",
            "content" : "企业应有负责质量工作的领导，应设置相应的质量管理机构或负责质量管理工作的人员。"
          },
          {
            "id" : 2,
            "itemNumber" : "1.2",
            "itemName" : "管理职责",
            "content" : "应规定各有关部门、人员的质量职责、权限和相互关系。"
          }
        ]
      }
    ]
  }
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

### 企业定位接口

地址：http://domain\_name:port/api/corp/locate

请求方式：POST

 

**入参：**

| **字段** | **含义**                   | **必传** | **备注**                     |
|----------|----------------------------|----------|------------------------------|
| corp\_id | 企业ID                     | Y        | 由“未核查的企业查询接口”返回 |
| location | 根据经纬度解析出的实际地址 | Y        | 例如：奥体大街69号           |

 

**请求示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
POST /api/corp/locate HTTP/1.1 
Content-Type: application/x-www-form-urlencoded 
Host: domain_name:port 
Content-Length: 124 
Connection: Keep-Alive 
Cache-Control: no-cache 

corp_id=4344&location=奥体大街69号
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

**响应：**

| **字段**     | **含义**         | **必传** | **备注** |
|--------------|------------------|----------|----------|
| id           | 企业ID           | Y        |          |
| name         | 企业名称         | Y        |          |
| addr         | 企业住所         | Y        |          |
| productType  | 产品类型         | Y        |          |
| productName  | 产品名称         | Y        |          |
| locationAddr | 定位到的实际地址 | N        |          |

 

**响应示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
{
  "code" : 1,
  "body" : {
    "success" : true,
    "data" : {
      "id" : 4344,
      "name" : "江苏省耐火材料有限公司",
      "addr" : "南京市",
      "productType" : "耐火材料",
      "productName" : "耐火材料",
      "locationAddr" : "江苏省南京市建邺区沙洲街道富春江东街77号"
    }
  }
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

### 获取单个企业信息

地址：http://domain\_name:port/api/corp/info

请求方式：GET/POST（建议GET）

 

**入参：**

| **字段** | **含义** | **必传** | **备注** |
|----------|----------|----------|----------|
| corp\_id | 企业ID   | Y        |          |

 

**请求示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
http://domain_name:port/api/corp/info?corp_id=4344
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

**响应：**

| **字段**     | **含义**           | **必传** | **备注** |
|--------------|--------------------|----------|----------|
| id           | 企业ID             | Y        |          |
| name         | 企业名称           | Y        |          |
| productName  | 产品名称           | Y        |          |
| productType  | 产品类型           | Y        |          |
| addr         | 企业住所           | Y        |          |
| locationAddr | 实际定位得到的地址 | N        |          |

**响应示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
{
  "code" : 1,
  "body" : {
    "success" : true,
    "data" : {
      "id" : 4344,
      "name" : "江苏省耐火材料有限公司",
      "addr" : "南京市",
      "productType" : "耐火材料",
      "productName" : "耐火材料",
      "locationAddr" : "中国江苏省南京市建邺区建邺区新城科技园楠溪江东街36号" 
    }
  }
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

### 审查员审查计划查询接口（我的计划）

地址：http://domain\_name:port/corp/plans

请求方式：GET/POST（建议GET）

 

**入参：**

| **字段** | **含义**     | **必传** | **备注** |
|----------|--------------|----------|----------|
| uid      | 审查员账号ID | Y        |          |
| keyword  | 搜索关键字   | N        |          |

 

**请求示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
http://domain_name:port/api/corp/plans?uid=5533&keyword=江苏
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

**响应：**

| **字段**       | **含义**   | **必传** | **备注**                                                       |
|----------------|------------|----------|----------------------------------------------------------------|
| [].corpId      | 企业ID     | Y        |                                                                |
| [].corpName    | 企业名称   | Y        |                                                                |
| [].corpAddr    | 企业住所   | Y        |                                                                |
| [].linkTel     | 联系人电话 | Y        |                                                                |
| [].linkMan     | 联系人姓名 | Y        |                                                                |
| [].productType | 产品类型   | Y        |                                                                |
| [].productName | 产品名称   | Y        |                                                                |
| [].censorNames | 审查员列表 | Y        | 审查员姓名用逗号连接的字符串                                   |
| [].appointDate | 委派时间   | Y        | 时间戳                                                         |
| [].checkDate   | 审查日期   | N        | 时间戳                                                         |
| [].finishDate  | 完成时间   | N        | 时间戳                                                         |
| [].planStatus  | 计划状态   | Y        | 02：未核查；03, 04：已核查；05：已终止；06：已取消；07：已超期 |

 

**响应示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
{
  "code" : 1,
  "body" : {
    "success" : true,
    "data" : [
      {
        "corpId" : 4344,
        "corpName" : "江苏省耐火材料有限公司",
        "corpAddr" : "南京市",
        "linkTel" : "15070873750",
        "linkMan" : "陈达",
        "productType" : "耐火材料",
        "productName" : "耐火材料",
        "censorNames" : "韩凯",
        "appointDate" : "1453910400",
        "checkDate" : "1453910400",
        "finishDate" : "1453910400",
        "planStatus" : "02"
      }
    ]
  }
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

### 查询审查结果接口

地址：http://domain\_name:port/api/corp/check\_result

请求方式：GET/POST（建议GET）

 

**入参：**

| **字段** | **含义** | **必传** | **备注** |
|----------|----------|----------|----------|
| corp\_id | 企业ID   | Y        |          |

 

**请求示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
http://domain_name:port/api/corp/check_result?corp_id=1
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

**响应：**

| **字段**          | **含义**     | **必传** | **备注** |
|-------------------|--------------|----------|----------|
| indeedCheckResult | 实地检验结论 | N        |          |
| sampleCheckResult | 抽样检验结论 | N        |          |
| finalCheckResult  | 终审建议     | N        |          |

 

**响应示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
{
  "code" : 1,
  "body" : {
    "success" : true,
    "data" : {
      "indeedCheckResult" : "不合格，企业拒绝审查",
      "sampleCheckResult" : "生产许可证产品抽样检验通过",
      "finalCheckResult" : "合格"
    }
  }
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

### 企业照片列表信息接口

用户获取企业对应核查项目的照片信息

地址：http://domain\_name:port/api/corp/photos

请求方式：GET/POST（建议GET）

 

**入参：**

| **字段** | **含义**   | **必传** | **备注** |
|----------|------------|----------|----------|
| corp\_id | 企业ID     | Y        |          |
| item\_id | 核查项目ID | Y        |          |

 

**请求示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
http://domain_name:port/api/corp/photos?corp_id=4433&item_id=1
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

**响应：**

| **字段**  | **含义**        | **必传** | **备注** |
|-----------|-----------------|----------|----------|
| [].key    | 产品名称        | Y        |          |
| [].values | 产品照片URL列表 | N        |          |

 

**响应示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
{
  "code" : 1,
  "body" : {
    "success" : true,
    "data" : [
      {
        "product" : "聚氯乙烯绝缘控制电缆",
        "photoUrls" : [
          "/api/checkitem/photo?photo_id=7383",
          "/api/checkitem/photo?photo_id=7384"
        ]
      },
      {
        "product" : "直焊聚氨酯漆包铜圆线",
        "photoUrls" : [
          
        ]
      }
    ]
  }
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

### 核查项目照片上传接口

地址：http://domain\_name:port/api/checkitem/photo

请求方式：POST（multipart/form-data）

 

**入参：**

| **字段**     | **含义**         | **必传** | **备注**                       |
|--------------|------------------|----------|--------------------------------|
| corp\_id     | 企业ID           | Y        |                                |
| item\_id     | 核查项ID         | Y        | 由 “未核查的企业查询接口” 返回 |
| item\_number | 核查项序号       | Y        | 例如：”1.1"                    |
| product\_id  | 企业申报的产品ID | Y        | 由 “未核查的企业查询接口” 返回 |
| remark       | 照片备注信息     | N        |                                |
| photo        | 照片数据         | Y        |                                |

 

**请求示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
POST /api/checkitem/photo HTTP/1.1
Host: localhost:8000
Content-Type: multipart/form-data;boundary=----175a5274fa537f856d116be2f6542033
Connection: keep-alive
Accept: */*
User-Agent: iOSDemo/1 CFNetwork/758.2.8 Darwin/15.2.0
Content-Length: 42977
Accept-Language: en-us
Accept-Encoding: gzip, deflate
------175a5274fa537f856d116be2f6542033
Content-Disposition: form-data; name="item_id"

1
------175a5274fa537f856d116be2f6542033
Content-Disposition: form-data; name="item_number"

1.1
------175a5274fa537f856d116be2f6542033
Content-Disposition: form-data; name="product_id"

10
------175a5274fa537f856d116be2f6542033
Content-Disposition: form-data; name="remark"

备注信息
------175a5274fa537f856d116be2f6542033
Content-Disposition: form-data; name="photo"; filename="photo.jpg"
Content-Type: image/jpeg

[image data ...]
------175a5274fa537f856d116be2f6542033--
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

**响应：**

该接口响应的数据结构比较特殊，data字段为

| **字段**       | **含义**              | **必传** | **备注**                          |
|----------------|-----------------------|----------|-----------------------------------|
| [].product     | 产品名称              | Y        |                                   |
| [].productUrls | 产品对应的照片URL列表 | N        | 此url为相对url，需要拼接API根地址 |

 

**响应示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
{
  "code" : 1,
  "body" : {
    "success" : true,
    "data" : [
      {
        "product" : "聚氯乙烯绝缘控制电缆",
        "photoUrls" : [
          "/api/checkitem/photo?photo_id=7383",
          "/api/checkitem/photo?photo_id=7384"
        ]
      },
      {
        "product" : "直焊聚氨酯漆包铜圆线",
        "photoUrls" : [
          
        ]
      }
    ]
  }
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

### 核查项目照片下载接口

地址：http://domain\_name:port/api/checkitem/photo

请求方式：GET

 

**入参：**

| **字段**  | **含义** | **必传** | **备注** |
|-----------|----------|----------|----------|
| photo\_id | 照片ID   | Y        |          |

 

**请求示例：**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
http://domain_name:port/api/checkitem/photo?photo_id=1
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 

**响应：**

该接口为非数据接口，响应的内容即为图片。

 

附录
----

 

### 程序发行包结构

根目录

— app.war //程序可执行文件

— run.sh //linux 下的程序控制脚本（ 执行 run.sh start 来启动；执行 run.sh stop
来停止）

— run.bat //windows 下的启动脚本（前台运行，CTLR+C 停止）

 

### 部署环境要求

jdk/jre \>= 1.7.0 （需要设置 jdk/jre 环境变量）

启动后，将会在 run.sh 或 run.bat 同级目录创建 data
目录，此目录包含程序必要配置和数据以及缓存，请不要擅自修改其中的内容。
